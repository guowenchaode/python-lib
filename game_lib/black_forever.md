# 暗黑破坏神窗口监控工具功能总结
## 一、 核心定位
一款基于千分比坐标的窗口监控与脚本执行工具，专为暗黑破坏神游戏设计，支持按键坐标记录、脚本导入导出、自动化执行及可视化气泡提示。

## 二、 核心功能点
### 1.  窗口监控与主程序选择
- 自动扫描并列出所有包含“暗黑破坏神”标题的窗口
- 支持双击选中目标主程序，记录窗口的位置与尺寸参数
- 实时监控主程序是否处于前台运行状态

### 2.  千分比坐标系统
- 基于选中的主程序窗口计算相对千分比坐标（范围 0.000-1.000）
- 实时显示鼠标的绝对坐标与主程序内的相对千分比坐标
- 坐标计算自动适配窗口尺寸，避免分辨率变化导致的偏移

### 3.  按键坐标记录与管理
- 工具前台状态下，按下任意字母/数字/符号键，自动记录当前鼠标的千分比坐标
- 支持导出记录的按键-坐标数据为 CSV 文件，便于备份与分享
- 支持导入外部 CSV 格式的按键-坐标数据，快速创建脚本
- 提供清空记录功能，方便重新配置

### 4.  脚本执行与控制
- **脚本加载**：导入 CSV 格式的按键-坐标数据生成执行脚本
- **执行控制**
  - 启动脚本：按顺序执行脚本内的所有命令
  - 暂停脚本：临时中断执行，恢复后从当前位置继续
  - 停止脚本：终止执行并重置所有命令状态
- **循环执行**：支持开启循环执行模式，可自定义循环间隔时间（默认5秒）
- **后台保护**：可选开启“主程序后台时自动停止脚本”功能，防止无效执行
- **命令状态**：脚本表格中实时显示命令的状态（未执行/执行中/已完成/暂停/执行失败）

### 5.  可视化气泡提示（核心特色）
气泡提示为工具的核心可视化功能，支持**序号+按键名**双信息展示，且根据脚本状态智能切换显示模式：
- **气泡样式**：蓝色普通气泡/红色高亮气泡，透明度 50%，显示格式为 `[序号] 按键`
- **显示规则**
  - 停止/未运行状态：显示**全部命令**的蓝色气泡，清晰展示所有操作的坐标位置
  - 运行/暂停状态：仅显示**下一个待执行命令**的红色高亮气泡，聚焦执行进度
  - 倒计时命令自动隐藏气泡，避免干扰
- **快捷控制**：支持 F12 快捷键或界面按钮切换气泡的显示/隐藏状态

## 三、 附加功能
1.  自动安装依赖库：启动时自动检测 `pygetwindow` 和 `pyautogui` 库，缺失则自动安装
2.  线程安全设计：监控线程与执行线程分离，避免界面卡顿
3.  防故障设置：开启 `pyautogui` 防故障模式，避免鼠标移至屏幕边缘报错

## 四、 操作流程（简易）
1.  启动工具，等待扫描游戏窗口
2.  双击选中目标游戏窗口作为主程序
3.  切换工具至前台，移动鼠标并按键记录坐标
4.  导出记录为 CSV 或直接导入已有脚本 CSV
5.  点击启动脚本，观察气泡提示与执行状态
6.  可随时暂停/停止脚本，或切换气泡显示状态